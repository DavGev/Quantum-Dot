(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     30333,        753]
NotebookOptionsPosition[     28422,        718]
NotebookOutlinePosition[     28842,        734]
CellTagsIndexPosition[     28799,        731]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"===", "===", "==="}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"0", " ", "Bohr"}], "&"}], " ", "Rydberg", " ", "units"}], "===",
       "===", "==="}], "="}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[CurlyEpsilon]r", "=", "12.8"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"GaAs", " ", "dielectric", " ", "constant"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"m\:2080", "=", "9.1093837015*^-31"}], ";"}], 
   RowBox[{"(*", "kg", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"m\:2091", "=", 
     RowBox[{"0.067", " ", "m\:2080"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"m\:2095", "=", 
     RowBox[{"0.45", " ", "m\:2080"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"e", "=", "1.602176634*^-19"}], ";"}], 
   RowBox[{"(*", "C", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\:0127", "=", "1.054571817*^-34"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"J", "\[CenterDot]", "s"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CurlyEpsilon]0", "=", "8.8541878128*^-12"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"F", "\[CenterDot]", "m\:207b\.b9"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rB", "=", 
     RowBox[{
     "4", " ", "\[Pi]", " ", "\[CurlyEpsilon]0", " ", "\[CurlyEpsilon]r", " ", 
      RowBox[{
       RowBox[{"\:0127", "^", "2"}], "/", 
       RowBox[{"(", 
        RowBox[{"m\:2091", " ", 
         RowBox[{"e", "^", "2"}]}], ")"}]}]}]}], ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"~", "10.2"}], " ", "nm", " ", "for", " ", "GaAs"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ER", "=", 
     RowBox[{
      RowBox[{"\:0127", "^", "2"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", "m\:2091", " ", 
        RowBox[{"rB", "^", "2"}]}], ")"}]}]}], ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"~", "5.8"}], " ", "meV", " ", 
     RowBox[{"\[OpenCurlyDoubleQuote]", 
      RowBox[{"electron", " ", "Rydberg"}], "\[CloseCurlyDoubleQuote]"}]}], 
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"===", "===", "==="}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
       "0.1", " ", "Dimensionless", " ", "geometric", " ", "parameters"}], "===",
        "===", "==="}], "="}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"a", "=", "5"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"a", " ", "in", " ", "units", " ", "rB"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"c", "=", "0.2"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"c", " ", "in", " ", "units", " ", "rB"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"\[Delta]", "=", "0.02"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"softening", " ", "length"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"w", "[", 
       RowBox[{"a_", ",", " ", "c_"}], "]"}], "[", "\[Rho]_", "]"}], ":=", 
     RowBox[{"c", " ", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "-", 
        RowBox[{
         RowBox[{"\[Rho]", "^", "2"}], "/", 
         RowBox[{"a", "^", "2"}]}]}], "]"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Alpha]", "[", "c_", "]"}], ":=", 
     RowBox[{
      RowBox[{"\[Pi]", "^", "2"}], " ", "/", 
      RowBox[{"c", "^", "2"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Beta]", "[", 
      RowBox[{"a_", ",", " ", "c_"}], "]"}], ":=", 
     RowBox[{"\[Pi]", "/", 
      RowBox[{"(", 
       RowBox[{"a", " ", "c"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Psi]norm", "[", 
      RowBox[{"a_", ",", " ", "c_"}], "]"}], "[", 
     RowBox[{"nz_", ",", "nr_", ",", "m_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Beta]", "[", 
          RowBox[{"a", ",", "c"}], "]"}], " ", "nz"}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Abs", "[", "m", "]"}], "+", "1"}], ")"}]}], " ", 
      RowBox[{
       RowBox[{"Factorial", "[", "nr", "]"}], "/", "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{"\[Pi]", " ", 
         RowBox[{"Gamma", "[", 
          RowBox[{"nr", "+", 
           RowBox[{"Abs", "[", "m", "]"}], "+", "1"}], "]"}]}], ")"}]}]}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Psi]z", "[", 
        RowBox[{"a_", ",", " ", "c_"}], "]"}], "[", "nz_", "]"}], "[", 
      RowBox[{"\[Rho]_", ",", "z_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Sqrt", "[", 
       RowBox[{"2", "/", 
        RowBox[{
         RowBox[{"w", "[", 
          RowBox[{"a", ",", " ", "c"}], "]"}], "[", "\[Rho]", "]"}]}], "]"}], 
      " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"nz", " ", "\[Pi]", " ", 
        RowBox[{"z", "/", 
         RowBox[{
          RowBox[{"w", "[", 
           RowBox[{"a", ",", " ", "c"}], "]"}], "[", "\[Rho]", "]"}]}]}], 
       "]"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Psi]r", "[", 
        RowBox[{"a_", ",", " ", "c_"}], "]"}], "[", 
       RowBox[{"nz_", ",", "nr_", ",", "m_"}], "]"}], "[", "\[Rho]_", "]"}], ":=",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Rho]", "^", 
       RowBox[{"Abs", "[", "m", "]"}]}], 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "nz"}], " ", 
        RowBox[{"\[Beta]", "[", 
         RowBox[{"a", ",", " ", "c"}], "]"}], " ", 
        RowBox[{
         RowBox[{"\[Rho]", "^", "2"}], "/", "2"}]}], "]"}], " ", 
      RowBox[{"LaguerreL", "[", 
       RowBox[{"nr", ",", 
        RowBox[{"Abs", "[", "m", "]"}], ",", 
        RowBox[{"nz", " ", 
         RowBox[{"\[Beta]", "[", 
          RowBox[{"a", ",", "c"}], "]"}], " ", 
         RowBox[{"\[Rho]", "^", "2"}]}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Psi]", "[", 
        RowBox[{"a_", ",", " ", "c_"}], "]"}], "[", 
       RowBox[{"nz_", ",", "nr_", ",", "m_"}], "]"}], "[", 
      RowBox[{"\[Rho]_", ",", "\[CurlyPhi]_", ",", "z_"}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Psi]norm", "[", 
        RowBox[{"a", ",", "c"}], "]"}], "[", 
       RowBox[{"nz", ",", "nr", ",", "m"}], "]"}], "*", "\[IndentingNewLine]", 
      RowBox[{"Exp", "[", 
       RowBox[{"\[ImaginaryI]", " ", "m", " ", "\[CurlyPhi]"}], "]"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Psi]z", "[", 
         RowBox[{"a", ",", "c"}], "]"}], "[", "nz", "]"}], "[", 
       RowBox[{"\[Rho]", ",", "z"}], "]"}], "*", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Psi]r", "[", 
         RowBox[{"a", ",", "c"}], "]"}], "[", 
        RowBox[{"nz", ",", "nr", ",", "m"}], "]"}], "[", "\[Rho]", "]"}]}]}], 
    ";"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.960196101416091*^9, 3.960196369432*^9}, {
   3.9601964093630915`*^9, 3.9601968191055202`*^9}, {3.9601993111842732`*^9, 
   3.9601996876317453`*^9}, {3.9601998151024995`*^9, 3.9601998390197597`*^9}, 
   3.960199975003069*^9, {3.960200200977938*^9, 3.960200201320219*^9}, {
   3.960200930254904*^9, 3.960201155071619*^9}, {3.9602012832070937`*^9, 
   3.9602013086891766`*^9}, {3.9602015976310177`*^9, 3.9602018171098804`*^9}, 
   3.960201857806069*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"d97636d9-3c5e-49cd-8467-a755c14e571f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "checkNorm", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "checkNorm", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RMax", "->", "1"}], ",", 
      RowBox[{"(*", 
       RowBox[{
       "integrate", " ", "\[Rho]", " ", "up", " ", "to", " ", "the", " ", 
        "dot", " ", "radius"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"AccuracyGoal", "->", "8"}], ",", 
      RowBox[{"PrecisionGoal", "->", "8"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"checkNorm", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a_", ",", " ", "c_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"nz_", ",", "nr_", ",", "m_"}], "}"}], ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Rho]max", "=", 
        RowBox[{"OptionValue", "[", "RMax", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"acc", "=", 
        RowBox[{"OptionValue", "[", "AccuracyGoal", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"prec", "=", 
        RowBox[{"OptionValue", "[", "PrecisionGoal", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"NIntegrate", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"z", "=", 
           RowBox[{"u", " ", 
            RowBox[{
             RowBox[{"w", "[", 
              RowBox[{"a", ",", "c"}], "]"}], "[", "\[Rho]", "]"}]}]}], "}"}],
          ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Psi]", "[", 
               RowBox[{"a", ",", "c"}], "]"}], "[", 
              RowBox[{"nz", ",", "nr", ",", "m"}], "]"}], "[", 
             RowBox[{"\[Rho]", ",", "\[CurlyPhi]", ",", "z"}], "]"}], "]"}], "^",
            "2"}], "  ", "\[Rho]", " ", 
          RowBox[{
           RowBox[{"w", "[", 
            RowBox[{"a", ",", "c"}], "]"}], "[", "\[Rho]", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"\[Rho]", ",", "0", ",", 
         RowBox[{"a", "*", "\[Rho]max"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[CurlyPhi]", ",", "0", ",", 
         RowBox[{"2", " ", "\[Pi]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"u", ",", "0", ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"AccuracyGoal", "->", "acc"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PrecisionGoal", "->", "prec"}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9601996934302745`*^9, 3.9601996957854843`*^9}, {
  3.9601998887872763`*^9, 3.9601998896363473`*^9}, {3.9602018756645975`*^9, 
  3.9602018945729733`*^9}, {3.9602019310855637`*^9, 3.960201932189329*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"4dead45a-eff2-4154-9fd3-a64c3b00e1ef"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkNorm", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"a", ",", "c"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "1", ",", "3"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9601997045695167`*^9, 3.9601997719199357`*^9}, {
  3.9602004305545874`*^9, 3.960200465820368*^9}, {3.960200789394579*^9, 
  3.960200789922202*^9}, {3.96020190599087*^9, 3.9602019093651595`*^9}, {
  3.9602218290373507`*^9, 3.9602218339673643`*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"01115987-d73d-4853-8002-1502de03fb61"],

Cell[BoxData["0.9999999999999888`"], "Output",
 CellChangeTimes->{
  3.9601997102689962`*^9, {3.9601997420189495`*^9, 3.9601997469016757`*^9}, 
   3.9601997826401596`*^9, 3.960199830442209*^9, 3.9601999013372416`*^9, 
   3.96019998969528*^9, 3.9602002158771553`*^9, {3.9602004414189653`*^9, 
   3.9602004763445296`*^9}, 3.960200799870703*^9, 3.9602012669297853`*^9, 
   3.960201326023863*^9, 3.9602017680261703`*^9, {3.9602018823572483`*^9, 
   3.960201934057002*^9}, 3.960220020583121*^9, 3.96022183692947*^9, 
   3.960222015760268*^9, 3.9602252532896743`*^9, 3.960225812472068*^9},
 CellLabel->"Out[21]=",ExpressionUUID->"e9c0890c-fec1-4b7b-ac90-cafaab19cc57"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Energy", "[", 
      RowBox[{"a_", ",", " ", "c_"}], "]"}], "[", 
     RowBox[{"nz_", ",", "nr_", ",", "m_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Alpha]", "[", "c", "]"}], " ", 
      RowBox[{"nz", "^", "2"}]}], "+", 
     RowBox[{
      RowBox[{"\[Beta]", " ", "[", 
       RowBox[{"a", ",", "c"}], "]"}], "nz", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "nr"}], "+", 
        RowBox[{"Abs", "[", "m", "]"}], "+", "1"}], ")"}]}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"electron", "&"}], " ", "hole", " ", "energies", " ", 
    RowBox[{"in", "**", "Rydberg"}], " ", "units"}], "***)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Ee", "[", 
     RowBox[{"a_", ",", " ", "c_"}], "]"}], "[", 
    RowBox[{"nz_", ",", "nr_", ",", "m_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Energy", "[", 
     RowBox[{"a", ",", "c"}], "]"}], "[", 
    RowBox[{"nz", ",", "nr", ",", "m"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Eh", "[", 
     RowBox[{"a_", ",", " ", "c_"}], "]"}], "[", 
    RowBox[{"nz_", ",", "nr_", ",", "m_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"m\:2091", "/", "m\:2095"}], ")"}], " ", 
    RowBox[{
     RowBox[{"Energy", "[", 
      RowBox[{"a", ",", "c"}], "]"}], "[", 
     RowBox[{"nz", ",", "nr", ",", "m"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.9602019660675325`*^9, {3.960222399822425*^9, 3.960222400022807*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"2bb5f81c-547d-4de6-b199-7114b9831ed4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Vcyl", "[", 
    RowBox[{
    "\[Rho]1_", ",", "\[CurlyPhi]1_", ",", "z1_", ",", "\[Rho]2_", ",", 
     "\[CurlyPhi]2_", ",", "z2_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"R2", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"z1", "-", "z2"}], ")"}], "^", "2"}], "+", 
        RowBox[{"\[Rho]1", "^", "2"}], "+", 
        RowBox[{"\[Rho]2", "^", "2"}], "-", 
        RowBox[{"2", " ", "\[Rho]1", " ", "\[Rho]2", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[CurlyPhi]1", "-", "\[CurlyPhi]2"}], "]"}]}]}]}], "}"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"-", "1"}], "/", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"R2", "+", 
        RowBox[{"\[Delta]", "^", "2"}]}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.960897084438614*^9, 
  3.960897088772888*^9}},ExpressionUUID->"84fe31e6-8dba-f648-b476-\
c2e31a253862"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "MakeIntegrand", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeIntegrand", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nzE_", ",", "nrE_", ",", "mE_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"nzH_", ",", "nrH_", ",", "mH_"}], "}"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Rho]1", ",", "\[CurlyPhi]1", ",", "u1", ",", "\[Rho]2", ",", 
       "\[CurlyPhi]2", ",", "u2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"z1", "=", 
          RowBox[{"u1", " ", 
           RowBox[{"w", "[", "\[Rho]1", "]"}]}]}], ",", 
         RowBox[{"z2", "=", 
          RowBox[{"u2", " ", 
           RowBox[{"w", "[", "\[Rho]2", "]"}]}]}], ",", "\[CapitalPsi]e", ",",
          "\[CapitalPsi]h"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[CapitalPsi]e", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Psi]z", "[", "nzE", "]"}], "[", 
           RowBox[{"\[Rho]1", ",", "z1"}], "]"}], " ", 
          RowBox[{
           RowBox[{"\[Psi]r", "[", 
            RowBox[{"nzE", ",", "nrE", ",", "mE"}], "]"}], "[", 
           RowBox[{"\[Rho]1", ",", "\[CurlyPhi]1"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[CapitalPsi]h", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Psi]z", "[", "nzH", "]"}], "[", 
           RowBox[{"\[Rho]2", ",", "z2"}], "]"}], " ", 
          RowBox[{
           RowBox[{"\[Psi]r", "[", 
            RowBox[{"nzH", ",", "nrH", ",", "mH"}], "]"}], "[", 
           RowBox[{"\[Rho]2", ",", "\[CurlyPhi]2"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"\[CapitalPsi]e", " ", "\[CapitalPsi]h"}], "]"}], " ", 
         RowBox[{"Vcyl", "[", 
          RowBox[{
          "\[Rho]1", ",", "\[CurlyPhi]1", ",", "z1", ",", "\[Rho]2", ",", 
           "\[CurlyPhi]2", ",", "z2"}], "]"}], " ", "\[CapitalPsi]e", " ", 
         "\[CapitalPsi]h", " ", "*", "\[IndentingNewLine]", "\[Rho]1", " ", 
         "\[Rho]2", " ", 
         RowBox[{"w", "[", "\[Rho]1", "]"}], 
         RowBox[{"w", "[", "\[Rho]2", "]"}]}]}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9602104113942585`*^9, 3.9602105376601505`*^9}, {
   3.960210574595375*^9, 3.9602105928283215`*^9}, {3.9602106291475677`*^9, 
   3.9602106449617777`*^9}, {3.9602107001820354`*^9, 3.960210730945068*^9}, 
   3.9602108607466416`*^9, {3.960210902379486*^9, 3.9602109441640863`*^9}, {
   3.9602201197178736`*^9, 3.9602204636186504`*^9}, {3.96022049493773*^9, 
   3.9602205340401115`*^9}, {3.9602210712395477`*^9, 3.960221075119727*^9}, {
   3.960221483440748*^9, 3.9602214887945695`*^9}, {3.9602216510714226`*^9, 
   3.960221706133019*^9}, {3.960221751484787*^9, 3.9602217769055076`*^9}, {
   3.960225294956228*^9, 3.960225295949379*^9}, {3.9602255230918975`*^9, 
   3.960225549199122*^9}, {3.960225662916663*^9, 3.960225675478238*^9}, 
   3.9602257100999823`*^9, 3.960225820158248*^9, {3.9602263495929546`*^9, 
   3.9602263512024436`*^9}, {3.960226386550113*^9, 3.96022639180107*^9}, {
   3.960897105817581*^9, 
   3.960897109691353*^9}},ExpressionUUID->"ad664426-d44d-493a-a8aa-\
ca1095a4e072"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"f", "=", 
   RowBox[{
    RowBox[{"MakeIntegrand", "[", 
     RowBox[{"a", ",", "c"}], "]"}], "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"f", "[", 
  RowBox[{"0.5", ",", "0.1", ",", "0.5", ",", "0.1", ",", "0"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.9602209122214236`*^9, 3.960220951411089*^9}, {
  3.960221121511471*^9, 3.960221138472786*^9}, {3.960221539256996*^9, 
  3.960221541618898*^9}, {3.9602265626521688`*^9, 3.9602265655859027`*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"e5d70c9a-7de6-479f-909c-fe33ed580bd6"],

Cell[BoxData[
 RowBox[{"-", "9.313552939472796`*^-14"}]], "Output",
 CellChangeTimes->{{3.9602209246877017`*^9, 3.9602209524966674`*^9}, 
   3.9602210817573338`*^9, {3.9602211234362955`*^9, 3.960221139003047*^9}, 
   3.960221491087048*^9, 3.9602215420938253`*^9, 3.96022178265514*^9, 
   3.9602220194771686`*^9, {3.9602252144481936`*^9, 3.960225217965913*^9}, 
   3.9602252659658785`*^9, 3.9602252987054176`*^9, {3.9602255255118985`*^9, 
   3.9602256082331142`*^9}, 3.960225655320035*^9, {3.960225703863194*^9, 
   3.960225712195448*^9}, 3.9602258248227468`*^9, 3.960226397201538*^9, 
   3.9602265660199547`*^9},
 CellLabel->"Out[65]=",ExpressionUUID->"acaa3c2a-9a64-4bb6-9aaf-043eef68cc52"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "\[CapitalDelta]E", "]"}], "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RMax", "->", 
       RowBox[{"0.9", " ", "a"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Method", "->", 
       RowBox[{"{", 
        RowBox[{"\"\<QuasiMonteCarlo\>\"", ",", 
         RowBox[{"\"\<MaxPoints\>\"", "->", 
          RowBox[{"10", "^", "7"}]}]}], "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"AccuracyGoal", "->", "8"}], ",", 
      RowBox[{"PrecisionGoal", "->", "8"}], ",", 
      RowBox[{"MaxRecursion", "->", "6"}]}], "\[IndentingNewLine]", "}"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalDelta]E", "[", 
    RowBox[{"e_", ",", "h_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"rmax", "=", 
        RowBox[{"OptionValue", "[", "RMax", "]"}]}], ",", "f"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"f", "=", 
       RowBox[{"makeIntegrand", "[", 
        RowBox[{"e", ",", "h"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{
         "\[Rho]1", ",", "\[CurlyPhi]1", ",", "u1", ",", "\[Rho]2", ",", 
          "\[CurlyPhi]2", ",", "u2"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"\[Rho]1", ",", "0", ",", "rmax"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[CurlyPhi]1", ",", "0", ",", 
          RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"u1", ",", "0", ",", "1"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"\[Rho]2", ",", "0", ",", "rmax"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[CurlyPhi]2", ",", "0", ",", 
          RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"u2", ",", "0", ",", "1"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Method", "->", 
         RowBox[{"OptionValue", "[", "Method", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"AccuracyGoal", "->", 
         RowBox[{"OptionValue", "[", "AccuracyGoal", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PrecisionGoal", "->", 
         RowBox[{"OptionValue", "[", "PrecisionGoal", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"MaxRecursion", "->", 
         RowBox[{"OptionValue", "[", "MaxRecursion", "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.960220615735499*^9, 3.9602206222851286`*^9}, {
   3.9602206633952894`*^9, 3.960220840784664*^9}, {3.9602216012436547`*^9, 
   3.960221602874446*^9}, {3.9602250614677997`*^9, 3.960225114464503*^9}, {
   3.960225187308766*^9, 3.9602252085818367`*^9}, {3.9602253342652025`*^9, 
   3.9602253349650326`*^9}, 3.960225772866397*^9, {3.960226519229898*^9, 
   3.9602265228297606`*^9}, 
   3.9608971278146896`*^9},ExpressionUUID->"91ce41f6-ab69-4cd9-8ef3-\
2fce6318e0ab"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"g", "=", 
    RowBox[{"{", 
     RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"ground", " ", "state", " ", "tuple", " ", 
    RowBox[{"{", 
     RowBox[{"nz", ",", "nr", ",", "m"}], "}"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]E", "=", 
   RowBox[{
    RowBox[{"\[CapitalDelta]E", "[", 
     RowBox[{"a", ",", "c"}], "]"}], "[", 
    RowBox[{"g", ",", "g"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<E\:2091  = \>\"", ",", 
    RowBox[{
     RowBox[{"Ee", "[", 
      RowBox[{"a", ",", "c"}], "]"}], "@@", "g"}], ",", "\"\<  Ry\>\""}], 
   "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<E\:2095  = \>\"", ",", 
    RowBox[{
     RowBox[{"Eh", "[", 
      RowBox[{"a", ",", "c"}], "]"}], "@@", "g"}], ",", "\"\<  Ry\>\""}], 
   "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<\[CapitalDelta]E  = \>\"", ",", "\[Delta]E", 
    ",", "\"\<  Ry\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9602208497478695`*^9, 3.9602208743519893`*^9}, {
  3.960221849569461*^9, 3.960221933771428*^9}, {3.960225995247345*^9, 
  3.960226005990399*^9}, {3.960226445008854*^9, 3.960226451101636*^9}, {
  3.960897136168949*^9, 3.960897169981102*^9}, {3.960897240482691*^9, 
  3.960897265825962*^9}},ExpressionUUID->"9c4c9fc9-de9c-43dc-8d2d-\
3dfc7e58ade4"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate", "maxp", 
   "\"The integral failed to converge after \
\\!\\(\\*RowBox[{\\\"10000000\\\"}]\\) integrand evaluations. NIntegrate \
obtained \\!\\(\\*RowBox[{\\\"0.00012805935715071005`\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"0.0518462566360991`\\\"}]\\) for the integral and error \
estimates.\"", 2, 59, 5, 22558344065272047376, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9602208752653675`*^9, 3.9602215027018833`*^9, 
  3.9602215689373436`*^9, 3.9602217918872194`*^9, 3.96022185536978*^9, 
  3.960221935419976*^9, 3.9602220231546326`*^9, 3.96022240590427*^9, 
  3.9602252737481384`*^9, 3.9602253041969395`*^9, 3.960225358631774*^9, 
  3.960225741216047*^9, 3.960225851432974*^9, 3.960226024383337*^9, 
  3.9602264239426565`*^9, 3.9602264742343783`*^9, 3.9602265478608227`*^9},
 CellLabel->
  "During evaluation of \
In[59]:=",ExpressionUUID->"964749e1-594b-4045-babf-45f719c4933c"],

Cell[BoxData["249.8817026808237`"], "Output",
 CellChangeTimes->{{3.9602208565620246`*^9, 3.9602208753545094`*^9}, 
   3.9602215076203203`*^9, 3.9602215739210353`*^9, 3.960221797039171*^9, 
   3.960221860704105*^9, 3.960221940516622*^9, 3.960222028494376*^9, 
   3.960222411422138*^9, 3.9602252737649827`*^9, 3.960225304198865*^9, 
   3.960225358631774*^9, 3.9602257412493815`*^9, 3.960225851432974*^9, 
   3.960226024383337*^9, 3.9602264239511003`*^9, 3.9602264742343783`*^9, 
   3.9602265478719883`*^9},
 CellLabel->"Out[60]=",ExpressionUUID->"3ccea372-3f35-4f90-b4cc-3b61930e4037"],

Cell[BoxData["37.20460906581153`"], "Output",
 CellChangeTimes->{{3.9602208565620246`*^9, 3.9602208753545094`*^9}, 
   3.9602215076203203`*^9, 3.9602215739210353`*^9, 3.960221797039171*^9, 
   3.960221860704105*^9, 3.960221940516622*^9, 3.960222028494376*^9, 
   3.960222411422138*^9, 3.9602252737649827`*^9, 3.960225304198865*^9, 
   3.960225358631774*^9, 3.9602257412493815`*^9, 3.960225851432974*^9, 
   3.960226024383337*^9, 3.9602264239511003`*^9, 3.9602264742343783`*^9, 
   3.9602265478773065`*^9},
 CellLabel->"Out[61]=",ExpressionUUID->"b3f2f236-0990-44e0-a5c9-fe60e46d7ea8"],

Cell[BoxData["0.00012805935715071005`"], "Output",
 CellChangeTimes->{{3.9602208565620246`*^9, 3.9602208753545094`*^9}, 
   3.9602215076203203`*^9, 3.9602215739210353`*^9, 3.960221797039171*^9, 
   3.960221860704105*^9, 3.960221940516622*^9, 3.960222028494376*^9, 
   3.960222411422138*^9, 3.9602252737649827`*^9, 3.960225304198865*^9, 
   3.960225358631774*^9, 3.9602257412493815`*^9, 3.960225851432974*^9, 
   3.960226024383337*^9, 3.9602264239511003`*^9, 3.9602264742343783`*^9, 
   3.9602265478823752`*^9},
 CellLabel->"Out[62]=",ExpressionUUID->"c5f40791-c71d-4a8c-93df-7f6eef2e00ad"],

Cell[BoxData["287.0864398059924`"], "Output",
 CellChangeTimes->{{3.9602208565620246`*^9, 3.9602208753545094`*^9}, 
   3.9602215076203203`*^9, 3.9602215739210353`*^9, 3.960221797039171*^9, 
   3.960221860704105*^9, 3.960221940516622*^9, 3.960222028494376*^9, 
   3.960222411422138*^9, 3.9602252737649827`*^9, 3.960225304198865*^9, 
   3.960225358631774*^9, 3.9602257412493815`*^9, 3.960225851432974*^9, 
   3.960226024383337*^9, 3.9602264239511003`*^9, 3.9602264742343783`*^9, 
   3.960226547887761*^9},
 CellLabel->"Out[63]=",ExpressionUUID->"9bf0e7a5-a41c-4b3c-9829-d665066f84f3"]
}, Open  ]]
},
WindowSize->{574.8, 573.6},
WindowMargins->{{Automatic, -4.7999999999999545`}, {Automatic, 0}},
FrontEndVersion->"14.2 for Microsoft Windows (64-bit) (March 14, 2025)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"ed7f98f5-653d-46b5-9682-bad2c062466d"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 7766, 211, 751, "Input",ExpressionUUID->"d97636d9-3c5e-49cd-8467-a755c14e571f"],
Cell[8327, 233, 3161, 80, 351, "Input",ExpressionUUID->"4dead45a-eff2-4154-9fd3-a64c3b00e1ef"],
Cell[CellGroupData[{
Cell[11513, 317, 542, 11, 28, "Input",ExpressionUUID->"01115987-d73d-4853-8002-1502de03fb61"],
Cell[12058, 330, 662, 9, 32, "Output",ExpressionUUID->"e9c0890c-fec1-4b7b-ac90-cafaab19cc57"]
}, Open  ]],
Cell[12735, 342, 1690, 49, 123, "Input",ExpressionUUID->"2bb5f81c-547d-4de6-b199-7114b9831ed4"],
Cell[14428, 393, 1046, 29, 85, "Input",ExpressionUUID->"84fe31e6-8dba-f648-b476-c2e31a253862"],
Cell[15477, 424, 3442, 75, 199, "Input",ExpressionUUID->"ad664426-d44d-493a-a8aa-ca1095a4e072"],
Cell[CellGroupData[{
Cell[18944, 503, 731, 17, 47, "Input",ExpressionUUID->"e5d70c9a-7de6-479f-909c-fe33ed580bd6"],
Cell[19678, 522, 691, 10, 32, "Output",ExpressionUUID->"acaa3c2a-9a64-4bb6-9aaf-043eef68cc52"]
}, Open  ]],
Cell[20384, 535, 3241, 78, 351, "Input",ExpressionUUID->"91ce41f6-ab69-4cd9-8ef3-2fce6318e0ab"],
Cell[CellGroupData[{
Cell[23650, 617, 1450, 39, 104, "Input",ExpressionUUID->"9c4c9fc9-de9c-43dc-8d2d-3dfc7e58ade4"],
Cell[25103, 658, 952, 17, 62, "Message",ExpressionUUID->"964749e1-594b-4045-babf-45f719c4933c"],
Cell[26058, 677, 584, 8, 32, "Output",ExpressionUUID->"3ccea372-3f35-4f90-b4cc-3b61930e4037"],
Cell[26645, 687, 584, 8, 32, "Output",ExpressionUUID->"b3f2f236-0990-44e0-a5c9-fe60e46d7ea8"],
Cell[27232, 697, 589, 8, 32, "Output",ExpressionUUID->"c5f40791-c71d-4a8c-93df-7f6eef2e00ad"],
Cell[27824, 707, 582, 8, 32, "Output",ExpressionUUID->"9bf0e7a5-a41c-4b3c-9829-d665066f84f3"]
}, Open  ]]
}
]
*)

