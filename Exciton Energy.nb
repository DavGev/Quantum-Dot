(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     30158,        765]
NotebookOptionsPosition[     28279,        728]
NotebookOutlinePosition[     28728,        745]
CellTagsIndexPosition[     28685,        742]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"===", "===", "==="}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"0", " ", "Bohr"}], "&"}], " ", "Rydberg", " ", "units"}], "===",
       "===", "==="}], "="}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[CurlyEpsilon]r", "=", "12.8"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"GaAs", " ", "dielectric", " ", "constant"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"m\:2080", "=", "9.1093837015*^-31"}], ";"}], 
   RowBox[{"(*", "kg", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"m\:2091", "=", 
     RowBox[{"0.067", " ", "m\:2080"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"m\:2095", "=", 
     RowBox[{"0.45", " ", "m\:2080"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"e", "=", "1.602176634*^-19"}], ";"}], 
   RowBox[{"(*", "C", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\:0127", "=", "1.054571817*^-34"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"J", "\[CenterDot]", "s"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CurlyEpsilon]0", "=", "8.8541878128*^-12"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"F", "\[CenterDot]", "m\:207b\.b9"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rB", "=", 
     RowBox[{
     "4", " ", "\[Pi]", " ", "\[CurlyEpsilon]0", " ", "\[CurlyEpsilon]r", " ", 
      RowBox[{
       RowBox[{"\:0127", "^", "2"}], "/", 
       RowBox[{"(", 
        RowBox[{"m\:2091", " ", 
         RowBox[{"e", "^", "2"}]}], ")"}]}]}]}], ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"~", "10.2"}], " ", "nm", " ", "for", " ", "GaAs"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ER", "=", 
     RowBox[{
      RowBox[{"\:0127", "^", "2"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", "m\:2091", " ", 
        RowBox[{"rB", "^", "2"}]}], ")"}]}]}], ";"}], 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"~", "5.8"}], " ", "meV", " ", 
     RowBox[{"\[OpenCurlyDoubleQuote]", 
      RowBox[{"electron", " ", "Rydberg"}], "\[CloseCurlyDoubleQuote]"}]}], 
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"===", "===", "==="}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
       "0.1", " ", "Dimensionless", " ", "geometric", " ", "parameters"}], "===",
        "===", "==="}], "="}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"a", "=", "5"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"a", " ", "in", " ", "units", " ", "rB"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"c", "=", "0.2"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"c", " ", "in", " ", "units", " ", "rB"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"\[Delta]", "=", "0.01"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"softening", " ", "length"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"w", "[", 
       RowBox[{"a_", ",", " ", "c_"}], "]"}], "[", "\[Rho]_", "]"}], ":=", 
     RowBox[{"c", " ", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "-", 
        RowBox[{
         RowBox[{"\[Rho]", "^", "2"}], "/", 
         RowBox[{"a", "^", "2"}]}]}], "]"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Alpha]", "[", "c_", "]"}], ":=", 
     RowBox[{
      RowBox[{"\[Pi]", "^", "2"}], " ", "/", 
      RowBox[{"c", "^", "2"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Beta]", "[", 
      RowBox[{"a_", ",", " ", "c_"}], "]"}], ":=", 
     RowBox[{"\[Pi]", "/", 
      RowBox[{"(", 
       RowBox[{"a", " ", "c"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Psi]norm", "[", 
      RowBox[{"a_", ",", " ", "c_"}], "]"}], "[", 
     RowBox[{"nz_", ",", "nr_", ",", "m_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Beta]", "[", 
          RowBox[{"a", ",", "c"}], "]"}], " ", "nz"}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Abs", "[", "m", "]"}], "+", "1"}], ")"}]}], " ", 
      RowBox[{
       RowBox[{"Factorial", "[", "nr", "]"}], "/", "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{"\[Pi]", " ", 
         RowBox[{"Gamma", "[", 
          RowBox[{"nr", "+", 
           RowBox[{"Abs", "[", "m", "]"}], "+", "1"}], "]"}]}], ")"}]}]}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Psi]z", "[", 
        RowBox[{"a_", ",", " ", "c_"}], "]"}], "[", "nz_", "]"}], "[", 
      RowBox[{"\[Rho]_", ",", "z_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Sqrt", "[", 
       RowBox[{"2", "/", 
        RowBox[{
         RowBox[{"w", "[", 
          RowBox[{"a", ",", " ", "c"}], "]"}], "[", "\[Rho]", "]"}]}], "]"}], 
      " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"nz", " ", "\[Pi]", " ", 
        RowBox[{"z", "/", 
         RowBox[{
          RowBox[{"w", "[", 
           RowBox[{"a", ",", " ", "c"}], "]"}], "[", "\[Rho]", "]"}]}]}], 
       "]"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Psi]r", "[", 
        RowBox[{"a_", ",", " ", "c_"}], "]"}], "[", 
       RowBox[{"nz_", ",", "nr_", ",", "m_"}], "]"}], "[", "\[Rho]_", "]"}], ":=",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Rho]", "^", 
       RowBox[{"Abs", "[", "m", "]"}]}], 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "nz"}], " ", 
        RowBox[{"\[Beta]", "[", 
         RowBox[{"a", ",", " ", "c"}], "]"}], " ", 
        RowBox[{
         RowBox[{"\[Rho]", "^", "2"}], "/", "2"}]}], "]"}], " ", 
      RowBox[{"LaguerreL", "[", 
       RowBox[{"nr", ",", 
        RowBox[{"Abs", "[", "m", "]"}], ",", 
        RowBox[{"nz", " ", 
         RowBox[{"\[Beta]", "[", 
          RowBox[{"a", ",", "c"}], "]"}], " ", 
         RowBox[{"\[Rho]", "^", "2"}]}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Psi]", "[", 
        RowBox[{"a_", ",", " ", "c_"}], "]"}], "[", 
       RowBox[{"nz_", ",", "nr_", ",", "m_"}], "]"}], "[", 
      RowBox[{"\[Rho]_", ",", "\[CurlyPhi]_", ",", "z_"}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Psi]norm", "[", 
        RowBox[{"a", ",", "c"}], "]"}], "[", 
       RowBox[{"nz", ",", "nr", ",", "m"}], "]"}], "*", "\[IndentingNewLine]", 
      RowBox[{"Exp", "[", 
       RowBox[{"\[ImaginaryI]", " ", "m", " ", "\[CurlyPhi]"}], "]"}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Psi]z", "[", 
         RowBox[{"a", ",", "c"}], "]"}], "[", "nz", "]"}], "[", 
       RowBox[{"\[Rho]", ",", "z"}], "]"}], "*", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Psi]r", "[", 
         RowBox[{"a", ",", "c"}], "]"}], "[", 
        RowBox[{"nz", ",", "nr", ",", "m"}], "]"}], "[", "\[Rho]", "]"}]}]}], 
    ";"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.960196101416091*^9, 3.960196369432*^9}, {
   3.9601964093630915`*^9, 3.9601968191055202`*^9}, {3.9601993111842732`*^9, 
   3.9601996876317453`*^9}, {3.9601998151024995`*^9, 3.9601998390197597`*^9}, 
   3.960199975003069*^9, {3.960200200977938*^9, 3.960200201320219*^9}, {
   3.960200930254904*^9, 3.960201155071619*^9}, {3.9602012832070937`*^9, 
   3.9602013086891766`*^9}, {3.9602015976310177`*^9, 3.9602018171098804`*^9}, 
   3.960201857806069*^9, {3.9608977835358276`*^9, 3.960897785439186*^9}, {
   3.9608990389673405`*^9, 3.960899039723404*^9}, {3.9608991084909496`*^9, 
   3.9608991112084618`*^9}},
 CellLabel->
  "In[138]:=",ExpressionUUID->"d97636d9-3c5e-49cd-8467-a755c14e571f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "checkNorm", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "checkNorm", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RMax", "->", "1"}], ",", 
      RowBox[{"(*", 
       RowBox[{
       "integrate", " ", "\[Rho]", " ", "up", " ", "to", " ", "the", " ", 
        "dot", " ", "radius"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"AccuracyGoal", "->", "8"}], ",", 
      RowBox[{"PrecisionGoal", "->", "8"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"checkNorm", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a_", ",", " ", "c_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"nz_", ",", "nr_", ",", "m_"}], "}"}], ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Rho]max", "=", 
        RowBox[{"OptionValue", "[", "RMax", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"acc", "=", 
        RowBox[{"OptionValue", "[", "AccuracyGoal", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"prec", "=", 
        RowBox[{"OptionValue", "[", "PrecisionGoal", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"NIntegrate", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"z", "=", 
           RowBox[{"u", " ", 
            RowBox[{
             RowBox[{"w", "[", 
              RowBox[{"a", ",", "c"}], "]"}], "[", "\[Rho]", "]"}]}]}], "}"}],
          ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Psi]", "[", 
               RowBox[{"a", ",", "c"}], "]"}], "[", 
              RowBox[{"nz", ",", "nr", ",", "m"}], "]"}], "[", 
             RowBox[{"\[Rho]", ",", "\[CurlyPhi]", ",", "z"}], "]"}], "]"}], "^",
            "2"}], "  ", "\[Rho]", " ", 
          RowBox[{
           RowBox[{"w", "[", 
            RowBox[{"a", ",", "c"}], "]"}], "[", "\[Rho]", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"\[Rho]", ",", "0", ",", 
         RowBox[{"a", "*", "\[Rho]max"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[CurlyPhi]", ",", "0", ",", 
         RowBox[{"2", " ", "\[Pi]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"u", ",", "0", ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"AccuracyGoal", "->", "acc"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PrecisionGoal", "->", "prec"}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9601996934302745`*^9, 3.9601996957854843`*^9}, {
  3.9601998887872763`*^9, 3.9601998896363473`*^9}, {3.9602018756645975`*^9, 
  3.9602018945729733`*^9}, {3.9602019310855637`*^9, 3.960201932189329*^9}},
 CellLabel->
  "In[157]:=",ExpressionUUID->"4dead45a-eff2-4154-9fd3-a64c3b00e1ef"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkNorm", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"a", ",", "c"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "1", ",", "3"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9601997045695167`*^9, 3.9601997719199357`*^9}, {
  3.9602004305545874`*^9, 3.960200465820368*^9}, {3.960200789394579*^9, 
  3.960200789922202*^9}, {3.96020190599087*^9, 3.9602019093651595`*^9}, {
  3.9602218290373507`*^9, 3.9602218339673643`*^9}},
 CellLabel->
  "In[160]:=",ExpressionUUID->"01115987-d73d-4853-8002-1502de03fb61"],

Cell[BoxData["0.9999999999999888`"], "Output",
 CellChangeTimes->{
  3.9601997102689962`*^9, {3.9601997420189495`*^9, 3.9601997469016757`*^9}, 
   3.9601997826401596`*^9, 3.960199830442209*^9, 3.9601999013372416`*^9, 
   3.96019998969528*^9, 3.9602002158771553`*^9, {3.9602004414189653`*^9, 
   3.9602004763445296`*^9}, 3.960200799870703*^9, 3.9602012669297853`*^9, 
   3.960201326023863*^9, 3.9602017680261703`*^9, {3.9602018823572483`*^9, 
   3.960201934057002*^9}, 3.960220020583121*^9, 3.96022183692947*^9, 
   3.960222015760268*^9, 3.9602252532896743`*^9, 3.960225812472068*^9, 
   3.9608978255072308`*^9, 3.9608985273949337`*^9, 3.960899045234827*^9, 
   3.9608991172417374`*^9},
 CellLabel->
  "Out[160]=",ExpressionUUID->"c755a38e-5a95-c241-ac1e-1824a66ca6f0"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Energy", "[", 
      RowBox[{"a_", ",", " ", "c_"}], "]"}], "[", 
     RowBox[{"nz_", ",", "nr_", ",", "m_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Alpha]", "[", "c", "]"}], " ", 
      RowBox[{"nz", "^", "2"}]}], "+", 
     RowBox[{
      RowBox[{"\[Beta]", " ", "[", 
       RowBox[{"a", ",", "c"}], "]"}], "nz", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "nr"}], "+", 
        RowBox[{"Abs", "[", "m", "]"}], "+", "1"}], ")"}]}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"electron", "&"}], " ", "hole", " ", "energies", " ", 
    RowBox[{"in", "**", "Rydberg"}], " ", "units"}], "***)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Ee", "[", 
     RowBox[{"a_", ",", " ", "c_"}], "]"}], "[", 
    RowBox[{"nz_", ",", "nr_", ",", "m_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Energy", "[", 
     RowBox[{"a", ",", "c"}], "]"}], "[", 
    RowBox[{"nz", ",", "nr", ",", "m"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Eh", "[", 
     RowBox[{"a_", ",", " ", "c_"}], "]"}], "[", 
    RowBox[{"nz_", ",", "nr_", ",", "m_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"m\:2091", "/", "m\:2095"}], ")"}], " ", 
    RowBox[{
     RowBox[{"Energy", "[", 
      RowBox[{"a", ",", "c"}], "]"}], "[", 
     RowBox[{"nz", ",", "nr", ",", "m"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.9602019660675325`*^9, {3.960222399822425*^9, 3.960222400022807*^9}},
 CellLabel->
  "In[161]:=",ExpressionUUID->"2bb5f81c-547d-4de6-b199-7114b9831ed4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Vcyl", "[", 
    RowBox[{
    "\[Rho]e_", ",", "\[CurlyPhi]e_", ",", "ze_", ",", "\[Rho]h_", ",", 
     "\[CurlyPhi]h_", ",", "zh_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"R2", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ze", "-", "zh"}], ")"}], "^", "2"}], "+", 
        RowBox[{"\[Rho]e", "^", "2"}], "+", 
        RowBox[{"\[Rho]h", "^", "2"}], "-", 
        RowBox[{"2", " ", "\[Rho]e", " ", "\[Rho]h", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[CurlyPhi]e", "-", "\[CurlyPhi]h"}], "]"}]}]}]}], "}"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"-", "1"}], "/", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"R2", "+", 
        RowBox[{"\[Delta]", "^", "2"}]}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.960897084438614*^9, 3.960897088772888*^9}, {
  3.9608979569269047`*^9, 3.960897978574112*^9}},
 CellLabel->
  "In[164]:=",ExpressionUUID->"84fe31e6-8dba-f648-b476-c2e31a253862"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "MakeIntegrand", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MakeIntegrand", "[", 
     RowBox[{"a_", ",", "c_"}], "]"}], "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nze_", ",", "nre_", ",", "me_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"nzh_", ",", "nrh_", ",", "mh_"}], "}"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Rho]e", ",", "\[CurlyPhi]e", ",", "ue", ",", "\[Rho]h", ",", 
       "\[CurlyPhi]h", ",", "uh"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ze", "=", 
          RowBox[{"ue", " ", 
           RowBox[{
            RowBox[{"w", "[", 
             RowBox[{"a", ",", "c"}], "]"}], "[", "\[Rho]e", "]"}]}]}], ",", 
         RowBox[{"zh", "=", 
          RowBox[{"uh", " ", 
           RowBox[{
            RowBox[{"w", "[", 
             RowBox[{"a", ",", "c"}], "]"}], "[", "\[Rho]h", "]"}]}]}], ",", 
         "\[CapitalPsi]e", ",", "\[CapitalPsi]h"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[CapitalPsi]e", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Psi]", "[", 
            RowBox[{"a", ",", " ", "c"}], "]"}], "[", 
           RowBox[{"nze", ",", "nre", ",", "me"}], "]"}], "[", 
          RowBox[{"\[Rho]e", ",", "\[CurlyPhi]e", ",", "ze"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[CapitalPsi]h", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Psi]", "[", 
            RowBox[{"a", ",", " ", "c"}], "]"}], "[", 
           RowBox[{"nzh", ",", "nrh", ",", "mh"}], "]"}], "[", 
          RowBox[{"\[Rho]h", ",", "\[CurlyPhi]h", ",", "zh"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"\[CapitalPsi]e", " ", "\[CapitalPsi]h"}], "]"}], " ", 
         RowBox[{"Vcyl", "[", 
          RowBox[{
          "\[Rho]e", ",", "\[CurlyPhi]e", ",", "ze", ",", "\[Rho]h", ",", 
           "\[CurlyPhi]h", ",", "zh"}], "]"}], " ", "\[CapitalPsi]e", " ", 
         "\[CapitalPsi]h", " ", "*", "\[IndentingNewLine]", "\[Rho]e", " ", 
         "\[Rho]h", " ", 
         RowBox[{
          RowBox[{"w", "[", 
           RowBox[{"a", ",", "c"}], "]"}], "[", "\[Rho]e", "]"}], 
         RowBox[{
          RowBox[{"w", "[", 
           RowBox[{"a", ",", "c"}], "]"}], "[", "\[Rho]h", "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9602104113942585`*^9, 3.9602105376601505`*^9}, {
   3.960210574595375*^9, 3.9602105928283215`*^9}, {3.9602106291475677`*^9, 
   3.9602106449617777`*^9}, {3.9602107001820354`*^9, 3.960210730945068*^9}, 
   3.9602108607466416`*^9, {3.960210902379486*^9, 3.9602109441640863`*^9}, {
   3.9602201197178736`*^9, 3.9602204636186504`*^9}, {3.96022049493773*^9, 
   3.9602205340401115`*^9}, {3.9602210712395477`*^9, 3.960221075119727*^9}, {
   3.960221483440748*^9, 3.9602214887945695`*^9}, {3.9602216510714226`*^9, 
   3.960221706133019*^9}, {3.960221751484787*^9, 3.9602217769055076`*^9}, {
   3.960225294956228*^9, 3.960225295949379*^9}, {3.9602255230918975`*^9, 
   3.960225549199122*^9}, {3.960225662916663*^9, 3.960225675478238*^9}, 
   3.9602257100999823`*^9, 3.960225820158248*^9, {3.9602263495929546`*^9, 
   3.9602263512024436`*^9}, {3.960226386550113*^9, 3.96022639180107*^9}, {
   3.960897105817581*^9, 3.960897109691353*^9}, {3.9608979217162075`*^9, 
   3.9608979370214844`*^9}, {3.9608979857891884`*^9, 3.960898062070286*^9}, {
   3.9608981089682407`*^9, 3.960898164068163*^9}, {3.9608982336438866`*^9, 
   3.960898248522543*^9}},
 CellLabel->
  "In[165]:=",ExpressionUUID->"ad664426-d44d-493a-a8aa-ca1095a4e072"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"f", "=", 
   RowBox[{
    RowBox[{"MakeIntegrand", "[", 
     RowBox[{"a", ",", "c"}], "]"}], "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"f", "[", 
  RowBox[{"0.5", ",", "0", ",", "0.5", ",", "0.1", ",", "0", ",", "0.5"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.9602209122214236`*^9, 3.960220951411089*^9}, {
  3.960221121511471*^9, 3.960221138472786*^9}, {3.960221539256996*^9, 
  3.960221541618898*^9}, {3.9602265626521688`*^9, 3.9602265655859027`*^9}, {
  3.9608978734704266`*^9, 3.96089787397472*^9}, {3.960898194730648*^9, 
  3.9608982080966663`*^9}},
 CellLabel->
  "In[167]:=",ExpressionUUID->"e5d70c9a-7de6-479f-909c-fe33ed580bd6"],

Cell[BoxData[
 RowBox[{"-", "0.22084936941820926`"}]], "Output",
 CellChangeTimes->{{3.9602209246877017`*^9, 3.9602209524966674`*^9}, 
   3.9602210817573338`*^9, {3.9602211234362955`*^9, 3.960221139003047*^9}, 
   3.960221491087048*^9, 3.9602215420938253`*^9, 3.96022178265514*^9, 
   3.9602220194771686`*^9, {3.9602252144481936`*^9, 3.960225217965913*^9}, 
   3.9602252659658785`*^9, 3.9602252987054176`*^9, {3.9602255255118985`*^9, 
   3.9602256082331142`*^9}, 3.960225655320035*^9, {3.960225703863194*^9, 
   3.960225712195448*^9}, 3.9602258248227468`*^9, 3.960226397201538*^9, 
   3.9602265660199547`*^9, 3.960897831771492*^9, 3.960897874661524*^9, 
   3.9608980722996483`*^9, {3.960898170810583*^9, 3.960898208576044*^9}, 
   3.960898250500458*^9, 3.960898366460169*^9, 3.9608985348635254`*^9, 
   3.9608990513879566`*^9, 3.9608991191337624`*^9},
 CellLabel->
  "Out[168]=",ExpressionUUID->"06f01a3e-203e-d44c-b943-dfcc391ec5d4"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalDelta]E", "[", 
     RowBox[{"a_", ",", "c_"}], "]"}], "[", 
    RowBox[{"e_", ",", "h_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"rmax", "=", "0.9"}], ",", "f"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"f", "=", 
       RowBox[{
        RowBox[{"MakeIntegrand", "[", 
         RowBox[{"a", ",", "c"}], "]"}], "[", 
        RowBox[{"e", ",", "h"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{
         "\[Rho]1", ",", "\[CurlyPhi]1", ",", "u1", ",", "\[Rho]2", ",", 
          "\[CurlyPhi]2", ",", "u2"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"\[Rho]1", ",", "0", ",", 
          RowBox[{"a", " ", "rmax"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[CurlyPhi]1", ",", "0", ",", 
          RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"u1", ",", "0", ",", "1"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"\[Rho]2", ",", "0", ",", 
          RowBox[{"a", " ", "rmax"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[CurlyPhi]2", ",", "0", ",", 
          RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"u2", ",", "0", ",", "1"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Method", "->", 
         RowBox[{"{", 
          RowBox[{"\"\<AdaptiveQuasiMonteCarlo\>\"", ",", 
           RowBox[{"\"\<BisectionDithering\>\"", "->", "0"}], ",", 
           RowBox[{"MaxPoints", "->", 
            RowBox[{"10", "^", "6"}]}]}], "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"AccuracyGoal", "->", "20"}], ",", "\[IndentingNewLine]", 
        RowBox[{"PrecisionGoal", "->", "100"}]}], "\[IndentingNewLine]", 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.960220615735499*^9, 3.9602206222851286`*^9}, {
   3.9602206633952894`*^9, 3.960220840784664*^9}, {3.9602216012436547`*^9, 
   3.960221602874446*^9}, {3.9602250614677997`*^9, 3.960225114464503*^9}, {
   3.960225187308766*^9, 3.9602252085818367`*^9}, {3.9602253342652025`*^9, 
   3.9602253349650326`*^9}, 3.960225772866397*^9, {3.960226519229898*^9, 
   3.9602265228297606`*^9}, 3.9608971278146896`*^9, {3.960898287456011*^9, 
   3.960898296999981*^9}, {3.9608984361905785`*^9, 3.9608984418801403`*^9}, {
   3.9608984735846653`*^9, 3.9608984738845406`*^9}, {3.96089856584721*^9, 
   3.9608985664992714`*^9}, {3.960898632448572*^9, 3.960898632593069*^9}, {
   3.960898688403284*^9, 3.9608987038490334`*^9}, {3.960898941532322*^9, 
   3.9608990202561607`*^9}, {3.960899073841833*^9, 3.9608990761247864`*^9}},
 CellLabel->
  "In[169]:=",ExpressionUUID->"91ce41f6-ab69-4cd9-8ef3-2fce6318e0ab"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ground", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]E", "=", 
   RowBox[{
    RowBox[{"\[CapitalDelta]E", "[", 
     RowBox[{"a", ",", "c"}], "]"}], "[", 
    RowBox[{"ground", ",", "ground"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<E\:2091  = \>\"", ",", 
    RowBox[{
     RowBox[{"Ee", "[", 
      RowBox[{"a", ",", "c"}], "]"}], "@@", "ground"}], ",", "\"\<  Ry\>\""}],
    "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<E\:2095  = \>\"", ",", 
    RowBox[{
     RowBox[{"Eh", "[", 
      RowBox[{"a", ",", "c"}], "]"}], "@@", "ground"}], ",", "\"\<  Ry\>\""}],
    "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<\[CapitalDelta]E  = \>\"", ",", "\[Delta]E", 
    ",", "\"\<  Ry\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9602208497478695`*^9, 3.9602208743519893`*^9}, {
  3.960221849569461*^9, 3.960221933771428*^9}, {3.960225995247345*^9, 
  3.960226005990399*^9}, {3.960226445008854*^9, 3.960226451101636*^9}, {
  3.960897136168949*^9, 3.960897169981102*^9}, {3.960897240482691*^9, 
  3.960897265825962*^9}, {3.9608987289232903`*^9, 3.9608987380319576`*^9}, {
  3.960898775435112*^9, 3.960898775541662*^9}},
 CellLabel->
  "In[170]:=",ExpressionUUID->"9c4c9fc9-de9c-43dc-8d2d-3dfc7e58ade4"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate", "maxp", 
   "\"The integral failed to converge after \
\\!\\(\\*RowBox[{\\\"1000100\\\"}]\\) integrand evaluations. NIntegrate \
obtained \\!\\(\\*RowBox[{\\\"-\\\", \\\"1.9415514493405335`\\\"}]\\) and \\!\
\\(\\*RowBox[{\\\"0.00686939006526095`\\\"}]\\) for the integral and error \
estimates.\"", 2, 171, 17, 29014975550748537731, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{{3.960898718008749*^9, 3.960898739808298*^9}, {
   3.960898984305664*^9, 3.9608990815062485`*^9}, 3.960899124250057*^9},
 CellLabel->
  "During evaluation of \
In[170]:=",ExpressionUUID->"4adda89e-5d9a-5d47-a57b-95853fa74590"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"E\:2091  = \"\>", "\[InvisibleSpace]", "249.8817026808237`", 
   "\[InvisibleSpace]", "\<\"  Ry\"\>"}],
  SequenceForm["E\:2091  = ", 249.8817026808237, "  Ry"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9608987180247593`*^9, 3.960898739808298*^9}, {
   3.960898984335306*^9, 3.9608990815274773`*^9}, 3.9608991242610893`*^9},
 CellLabel->
  "During evaluation of \
In[170]:=",ExpressionUUID->"2f47571b-5222-0041-b65e-130fb0622719"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"E\:2095  = \"\>", "\[InvisibleSpace]", "37.20460906581153`", 
   "\[InvisibleSpace]", "\<\"  Ry\"\>"}],
  SequenceForm["E\:2095  = ", 37.20460906581153, "  Ry"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9608987180247593`*^9, 3.960898739808298*^9}, {
   3.960898984335306*^9, 3.9608990815274773`*^9}, 3.9608991242610893`*^9},
 CellLabel->
  "During evaluation of \
In[170]:=",ExpressionUUID->"5bc96f71-b3a1-414c-b5dd-4ec907cca785"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[CapitalDelta]E  = \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "1.9415514493405335`"}], "\[InvisibleSpace]", "\<\"  Ry\"\>"}],
  SequenceForm["\[CapitalDelta]E  = ", -1.9415514493405335`, "  Ry"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.9608987180247593`*^9, 3.960898739808298*^9}, {
   3.960898984335306*^9, 3.9608990815274773`*^9}, 3.9608991242610893`*^9},
 CellLabel->
  "During evaluation of \
In[170]:=",ExpressionUUID->"6c077f9a-448d-cc44-8d91-b045626ee8aa"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{574.8, 573.6},
WindowMargins->{{Automatic, -4.7999999999999545`}, {Automatic, 0}},
Magnification:>1. Inherited,
FrontEndVersion->"14.2 for Microsoft Windows (64-bit) (March 14, 2025)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"ed7f98f5-653d-46b5-9682-bad2c062466d"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 7925, 214, 751, "Input",ExpressionUUID->"d97636d9-3c5e-49cd-8467-a755c14e571f"],
Cell[8486, 236, 3165, 81, 351, "Input",ExpressionUUID->"4dead45a-eff2-4154-9fd3-a64c3b00e1ef"],
Cell[CellGroupData[{
Cell[11676, 321, 546, 12, 28, "Input",ExpressionUUID->"01115987-d73d-4853-8002-1502de03fb61"],
Cell[12225, 335, 768, 12, 32, "Output",ExpressionUUID->"c755a38e-5a95-c241-ac1e-1824a66ca6f0"]
}, Open  ]],
Cell[13008, 350, 1694, 50, 123, "Input",ExpressionUUID->"2bb5f81c-547d-4de6-b199-7114b9831ed4"],
Cell[14705, 402, 1120, 30, 85, "Input",ExpressionUUID->"84fe31e6-8dba-f648-b476-c2e31a253862"],
Cell[15828, 434, 3881, 86, 199, "Input",ExpressionUUID->"ad664426-d44d-493a-a8aa-ca1095a4e072"],
Cell[CellGroupData[{
Cell[19734, 524, 846, 20, 47, "Input",ExpressionUUID->"e5d70c9a-7de6-479f-909c-fe33ed580bd6"],
Cell[20583, 546, 934, 14, 32, "Output",ExpressionUUID->"06f01a3e-203e-d44c-b943-dfcc391ec5d4"]
}, Open  ]],
Cell[21532, 563, 3031, 67, 237, "Input",ExpressionUUID->"91ce41f6-ab69-4cd9-8ef3-2fce6318e0ab"],
Cell[CellGroupData[{
Cell[24588, 634, 1434, 36, 104, "Input",ExpressionUUID->"9c4c9fc9-de9c-43dc-8d2d-3dfc7e58ade4"],
Cell[26025, 672, 688, 14, 44, "Message",ExpressionUUID->"4adda89e-5d9a-5d47-a57b-95853fa74590"],
Cell[CellGroupData[{
Cell[26738, 690, 490, 10, 22, "Print",ExpressionUUID->"2f47571b-5222-0041-b65e-130fb0622719"],
Cell[27231, 702, 490, 10, 22, "Print",ExpressionUUID->"5bc96f71-b3a1-414c-b5dd-4ec907cca785"],
Cell[27724, 714, 527, 10, 22, "Print",ExpressionUUID->"6c077f9a-448d-cc44-8d91-b045626ee8aa"]
}, Open  ]]
}, Open  ]]
}
]
*)

